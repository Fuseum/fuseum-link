console.log("background is running");chrome.runtime.onMessage.addListener((o,c,a)=>{switch(console.log("ðŸš€ ~ request.action:",o.action),o.action){case"openQR":const t=`https://fuseum-link.vertiree.com/extension/chainlink?extension-id=${chrome.runtime.id}`;chrome.windows.create({url:t,type:"popup",width:350,height:700,top:0,left:1e3});break;case"getAmazonTabId":return chrome.tabs.query({},n=>{const e=n.find(i=>i.url.includes("amazon"));e?(console.log("Amazon ID: ",e==null?void 0:e.id),a({tabId:e.id})):console.log("Amazon ID not found")}),!0;case"applyGiftCard":break;case"placeOrder":case"confirmApply":break;default:console.warn("Unknown action:",o.action);break}return!0});chrome.runtime.onMessageExternal.addListener(function(o,c,a){switch(o.action){case"login":chrome.storage.local.set({address:o.address},function(){}),a({status:"Address Received"});break;case"logout":chrome.storage.local.set({address:""},function(){}),a({status:"Logout"});break;case"sendGiftCodeFromChainLink":console.log("Receive apply gift card from chainLink"),chrome.tabs.query({},t=>{const n=t.find(e=>e.url.includes("amazon"));n&&(console.log("ðŸš€ ~ chrome.tabs.query ~ amazonTab:",n.id),chrome.tabs.sendMessage(n.id,{action:"applyGiftCard",giftCode:o.giftCode},e=>{console.log("Response from content script:",e),(e==null?void 0:e.result)=="applySuccess"&&a({status:"Success apply gift code"})}))});break}return!0});
